---
import { cn } from "@/utils/cn";
import { getMedia } from "@/utils/media";
import { getImageSet } from "@/utils/media";

interface Props {
  src: string;
  altText: string;
  className?: string;
  loading?: string;
  sizes?: string;
}

const {
  src,
  altText,
  className = "",
  loading = "lazy",
  sizes = "(min-width: 1024px) 40vw, (min-width: 768px) 50vw, 100vw",
} = Astro.props;

const mediaEntry = getMedia(src);
const image = getImageSet(mediaEntry.id);

const loadingOrder =
  loading === "lazy" || loading === "eager" ? loading : "lazy";
---

<img
  src={image.baseImage}
  srcset={image.srcSet}
  sizes={sizes}
  alt={altText}
  width={mediaEntry.width}
  height={mediaEntry.height}
  class={cn(className)}
  loading={loadingOrder}
/>

<!-- <img
  src={image.baseImage}
  srcset={image.srcSet}
  sizes={sizes}
  alt={altText}
  class={cn(className)}
  loading={loading}
  decoding="async"
/> -->
